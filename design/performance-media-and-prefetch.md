### Performance: Responsive Media, Prefetching, and Caching — Design Doc

#### Problem statement
We need consistently fast loads: responsive images, smart preloading/prefetching, and conservative video fetching to reduce bandwidth without sacrificing UX.

#### Goals
- Use `srcset`/width descriptors and tuned `sizes` for thumbnails/posters.
- Preload critical hero media; prefetch modal chunks and posters just before users need them.
- Delay heavy video network requests until modal open; always show a lightweight poster first.
- Keep assets immutable and cached via CDN with long TTL.

#### Strategy
- Images
  - Keep AVIF/WebP + JPEG fallback; add width‑based `srcset` (e.g., 320/480/640/960/1280) generated by `generate-images.mjs`.
  - Provide `sizes` per carousel (e.g., `(max-width: 768px) 33vw, (max-width: 1280px) 25vw, 20vw`).
- Preload/prefetch
  - `<link rel="preload" as="image">` for the hero.
  - Intersection observer on cards to prefetch modal JS chunk and poster when near viewport.
- Video policy
  - Poster first; fetch video src on modal open. Autoplay muted; controls available. Fallback to poster on error.
- Caching/CDN
  - Keep hashed filenames for images; far‑future cache. HTML short TTL.

#### Implementation plan (files)
- `scripts/generate-images.mjs`: generate multiple widths; emit `srcset` paths; update section files or compute sources at runtime by convention.
- `ItemCard.tsx`: use `<picture>` + `srcset`+`sizes` and IO‑based prefetch of modal/video poster.
- `index.html`: optional `<link rel="preload">` for hero media.

#### Acceptance criteria
- Lighthouse: LCP/INP/CLS within green; images served at appropriate sizes; minimal layout shift.
- Network: first modal open fetches video only then.

#### Test/QA
- DevTools: verify correct candidate selection from `srcset`; observe no early video download.
- Playwright: assert poster is shown before video request when opening modal.

#### Rollout
- Ship in stages: images → prefetch → video policy; measure vitals after each stage.
